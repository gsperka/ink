
<% if logged_in? %>
  <% if params[:parent_id] == nil %>
    <button id="sketch-submit">Save this sketch</button>
  <% else %>
    <button id="sketch-submit">Save this sketch</button>
  <% end %>
<% elsif logged_in_with_google? %>
    <button id="sketch-submit">Save this sketch</button>
<% else %>
  <h1 id="please-login" style="text-align:center;">Log in or sign up to save!</h1>
<% end %>

<p id='ink'> You have <span>10000</span> pixels left<p>

<div id="format-canvas-elements">
<div id="drawing-tools">
  <div class="st-brush-border">
    <div id="super-tiny-brush"></div>
  </div>
  <div class="tiny-brush-border">
    <div id="tiny-brush"></div>
  </div>
  <div class="small-brush-border">
    <div id="small-brush"></div>
  </div>
  <div class="medium-brush-border">
    <div id="medium-brush"></div>
  </div>
  <div class="large-brush-border">
    <div id="large-brush"></div>
  </div>
  <div id="red"></div>
  <div id="orange"></div>
  <div id="yellow"></div>
  <div id="green"></div>
  <div id="blue"></div>
  <div id="purple"></div>
  <div id="brown"></div>
  <div id="black"></div>
  <div id="gray"></div>
  <div id="white"></div>
  <button id="clear-canvas">Clear</button>
</div>
<div id="canvas-div" style='position:relative'>
  <canvas width="600" height="600" id="canvas-partial-box"></canvas>
</div>

<script type="text/javascript">
function pixelCount() {
  var totalDistance = 0;
  var lastSeenAt = {x: null, y: null};
  var click = false;

  $('#canvas-div').mousedown(function(event) {
    click = true;
  })

  $('#canvas-div').mouseup(function() {
    click = false;
  })

  $('#canvas-div').mouseleave(function() {
    click = false;
  })

  $('#canvas-div').mousemove(function(event) {
    if(click) {
      if(lastSeenAt.x) {
        totalDistance += (Math.sqrt(Math.pow(lastSeenAt.y - event.clientY, 2) + Math.pow(lastSeenAt.x - event.clientX, 2))) * fabcanvas.freeDrawingBrush.width;
      };
    }      
    if(totalDistance > Math.round(10000)) {

    }
    
    $('span').text(10000 - Math.round(totalDistance));
        
    
    lastSeenAt.x = event.clientX;
    lastSeenAt.y = event.clientY;
  });
}
 
</script>
